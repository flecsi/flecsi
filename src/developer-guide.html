

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Developer Guide &mdash; FleCSI 2.2.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  
  
    <link rel="canonical" href="http://www.flecsi.org/src/developer-guide.html"/>
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Internal Summary" href="summary.html" />
    <link rel="prev" title="API Reference" href="api.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/flecsi.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                Version: 2.2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Build &amp; Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="user-guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Developer Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="summary.html">Internal Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#style-guide">Style Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exceptions">Exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-rules">Additional Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#directory-structure">Directory Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#commits">Commits</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#versioning">Versioning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#branch-types">Branch Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tags">Tags</a></li>
<li class="toctree-l3"><a class="reference internal" href="#flecsi-version-file-version-and-flecsi-version">FleCSI Version File (<code class="docutils literal notranslate"><span class="pre">.version</span></code>) and <code class="docutils literal notranslate"><span class="pre">FLECSI_VERSION</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#workflow">Workflow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#published-documentation">Published Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spack-cheat-sheet">Spack Cheat Sheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="#git-cheat-sheet">Git Cheat Sheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-for-darwin">Building for Darwin</a></li>
<li class="toctree-l2"><a class="reference internal" href="#graphviz-notes">Graphviz Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#doxygen">Doxygen</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sphinx">Sphinx</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#headings">Headings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#links">Links</a></li>
<li class="toctree-l3"><a class="reference internal" href="#figures">Figures</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-blocks">Code Blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#console">Console</a></li>
<li class="toctree-l4"><a class="reference internal" href="#c">C++</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#literal-includes">Literal Includes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="team.html">Contributors</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">FleCSI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Developer Guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/src/developer-guide.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="developer-guide">
<h1>Developer Guide<a class="headerlink" href="#developer-guide" title="Permalink to this headline">¶</a></h1>
<p>This documentation is intended for developers of the core FleCSI
library.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Internal Summary</a><ul>
<li class="toctree-l2"><a class="reference internal" href="summary.html#components">Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="summary.html#hierarchy">Hierarchy</a></li>
<li class="toctree-l3"><a class="reference internal" href="summary.html#compound-clients">Compound clients</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="summary.html#data">Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="summary.html#task-separation">Task separation</a></li>
<li class="toctree-l3"><a class="reference internal" href="summary.html#storage">Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="summary.html#layouts">Layouts</a></li>
<li class="toctree-l3"><a class="reference internal" href="summary.html#definition">Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="summary.html#access">Access</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="summary.html#execution">Execution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="summary.html#levels">Levels</a></li>
<li class="toctree-l3"><a class="reference internal" href="summary.html#task-launches">Task launches</a></li>
<li class="toctree-l3"><a class="reference internal" href="summary.html#explicit-parallelism">Explicit parallelism</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="summary.html#topologies">Topologies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="summary.html#interfaces">Interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="summary.html#subcomponents">Subcomponents</a></li>
<li class="toctree-l3"><a class="reference internal" href="summary.html#predefined">Predefined</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="summary.html#utilities">Utilities</a></li>
</ul>
</li>
</ul>
</div>
<hr class="docutils" />
<section id="style-guide">
<h2>Style Guide<a class="headerlink" href="#style-guide" title="Permalink to this headline">¶</a></h2>
<p>Unless otherwise specified, follow the <a class="reference external" href="https://www.boost.org/development/requirements.html#Design_and_Programming">Boost “Design and Programming”
guidelines</a> and <a class="reference external" href="https://www.boost.org/development/header.html">header guidelines</a>.  They do not address purely stylistic
matters of indentation, spacing, and brace placement; those are addressed for
FleCSI by <code class="docutils literal notranslate"><span class="pre">clang-format</span></code>.</p>
<section id="exceptions">
<h3>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h3>
<p>Starting from the 2019 version:</p>
<ul class="simple">
<li><p>Optimization does matter for FleCSI, but only where the overhead it
introduces is expected to be a significant fraction of the application’s
runtime.</p></li>
<li><p>Obviously FleCSI uses certain additional libraries (like Legion).  Do not
add further dependencies without discussion.  As a single component, there
is no need to limit use of one part of FleCSI by another.</p></li>
<li><p>The ABI concerns, especially for Windows, are irrelevant.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">noexcept</span></code> has replaced exception-specifications and should be used as
appropriate, especially for move operations.</p></li>
<li><p>FleCSI uses its own unit-testing framework, not Boost’s.</p></li>
<li><p>The preferable line-length limit is 78 characters, so that even a diff of
such a file avoids the line continuations used in some displays.</p></li>
<li><p>Individual documentation files do not get their own copyright/license.</p></li>
<li><p>The source-file header is of course different.</p></li>
<li><p>FleCSI uses <code class="docutils literal notranslate"><span class="pre">flog_assert</span></code>, not <code class="docutils literal notranslate"><span class="pre">BOOST_ASSERT</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code> do not require special treatment.</p></li>
<li><p>Header and source files are suffixed with <code class="docutils literal notranslate"><span class="pre">.hh</span></code> and <code class="docutils literal notranslate"><span class="pre">.cc</span></code>.</p></li>
<li><p>There are no “primary directories”.</p></li>
<li><p>Code documentation is generated by Doxygen (where <code class="docutils literal notranslate"><span class="pre">\</span></code> is used instead of <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>), prose by Sphinx.</p></li>
</ul>
</section>
<section id="additional-rules">
<h3>Additional Rules<a class="headerlink" href="#additional-rules" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Class and enumeration names do not get a suffix <code class="docutils literal notranslate"><span class="pre">_t</span></code>.</p></li>
<li><p>Header names are “absolute” (<em>i.e.</em>, begin with <code class="docutils literal notranslate"><span class="pre">flecsi/</span></code>).</p></li>
<li><p>Function documentation uses the imperative mood.</p></li>
</ul>
</section>
<section id="directory-structure">
<h3>Directory Structure<a class="headerlink" href="#directory-structure" title="Permalink to this headline">¶</a></h3>
<p>The source code for the core FleCSI infrastructure is located in the
<em>top-level/flecsi</em> directory. For the most part, the subdirectories of
this directory correspond to the different namespaces in the core
infrastructure. Each of these subdirectories must contain a valid
CMakeLists.txt file. However, none of their children should have a
CMakeLists.txt file; the build system will not recurse beyond the
first level of subdirectories. Developers should use relative paths
within a CMakeLists.txt file to identify source in subdirectories.</p>
<p>Unit test files should be placed in the <em>test</em> subdirectory of each
namespace subdirectory. By convention, developers should not create
subdirectories within the test subdirectory.</p>
</section>
<section id="commits">
<h3>Commits<a class="headerlink" href="#commits" title="Permalink to this headline">¶</a></h3>
<p>While exceptions must occasionally be made to each of the following, ideally each commit should</p>
<ul class="simple">
<li><p>build and pass tests (partly to support <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">bisect</span></code>)</p></li>
<li><p>not add or change material changed later in the same merge request (partly to help <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">blame</span></code>)</p></li>
<li><p>include the smallest subset of an overall set of changes that follows the above rules</p></li>
<li><p>add or update any relevant documentation, including the <a class="reference internal" href="news.html#news"><span class="std std-ref">Release Notes</span></a></p></li>
<li><p>not be a meaningless merge from the destination branch (as introduced by <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code>)</p></li>
<li><p>have a meaningful message that follows the <a class="reference external" href="http://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html">50/72 rule</a></p></li>
<li><p>be properly formatted per <code class="docutils literal notranslate"><span class="pre">clang-format</span></code></p></li>
<li><p>either make only purely stylistic changes or make no such changes</p></li>
</ul>
<p>Stylistic changes should be rare and are best put in their own merge request (so that they do not complicate any substantive review).
Improvements to the style of code already being modified are encouraged, so long as they do not materially interfere with review.</p>
<p>Expending a reasonable effort to rewrite the history of a merge request to obtain the above properties is encouraged.
The usual tool is <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span> <span class="pre">-i</span></code>, although retroactive formatting is much easier with (a script that runs) <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">filter-branch</span></code>.</p>
<p>The name of the source branch of a merge request appears in the machine-generated commit that merges it.
Those names should therefore be meaningful; in particular, to avoid confusion they shouldn’t just be that of the destination branch (as from commands like <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">2.1</span></code>).</p>
</section>
</section>
<hr class="docutils" />
<section id="versioning">
<h2>Versioning<a class="headerlink" href="#versioning" title="Permalink to this headline">¶</a></h2>
<p>FleCSI uses the <a class="reference external" href="https://semver.org/">Semantic Versioning</a> system.
Note that it defines the three kinds of releases in terms of <em>restrictions</em> on what changes can appear in each, and that those restrictions are phrased in terms of the documented interface.
We interpret compatibility strictly in terms of source (with the inevitable judgment calls for things like SFINAE).
Even altogether new code can appear in a “patch” release if it serves to fix a bug or improve performance rather than as a new documented feature.</p>
<p>There is one active, shared branch for each of the three types of release, as described below.
Tags are used to identify releases as well as certain internal reference points for development.</p>
<section id="branch-types">
<h3>Branch Types<a class="headerlink" href="#branch-types" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>incompatible</dt><dd><p>The <em>develop</em> branch is where work on the next major release takes
place, potentially with interface and feature changes that are
<em>incompatible</em> with previous versions.</p>
</dd>
<dt>feature</dt><dd><p>Feature branches (named for their <em>major</em> version number, e.g., 1, 2,
3) are for feature development on the current major version.</p>
</dd>
<dt>release</dt><dd><p>Release branches (named for their <em>major.minor</em> version number, e.g.,
1.1, 1.2) are interface-stable versions of the code base.
At appropriate points, tags (named for their
<em>major.minor.patch</em> version number, e.g., 1.1.2) are used to identify
patched versions.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>At the time of writing, FleCSI has the following branches:</p>
<ul class="simple">
<li><p><strong>develop</strong> (incompatible)</p></li>
<li><p><strong>2</strong> (feature)</p></li>
<li><p><strong>2.1</strong> (release)</p></li>
</ul>
</div>
<p>In general, each change should be made on the most restrictive permissible relevant branch so as to minimize divergence between them (after merging) and the associated potential for future merge conflicts.
The condition of relevance pertains to an internal feature might be added only on the feature branch if it is not expected to accrue any clients on the release branch.
A sometimes countervailing consideration is stability: users expect that patch releases are less likely to cause problems when upgrading even though it is simply a bug if even a feature release does so.
It is also unfortunate to need to consider reverting a change because an official release is needed in the interval between introducing it and becoming confident in it.</p>
</section>
<section id="tags">
<h3>Tags<a class="headerlink" href="#tags" title="Permalink to this headline">¶</a></h3>
<p>Release tags should be created for each new release, with <em>v</em> and the
release version, e.g., <em>v1.4.1</em>.</p>
</section>
<section id="flecsi-version-file-version-and-flecsi-version">
<h3>FleCSI Version File (<code class="docutils literal notranslate"><span class="pre">.version</span></code>) and <code class="docutils literal notranslate"><span class="pre">FLECSI_VERSION</span></code><a class="headerlink" href="#flecsi-version-file-version-and-flecsi-version" title="Permalink to this headline">¶</a></h3>
<p>The contents of the <code class="docutils literal notranslate"><span class="pre">.version</span></code> file in the root of a FleCSI source
checkout is used to identify the branch type and version of
FleCSI. Given the three different branch types and tagged versioned
releases, its content will be one of the following four schemes:</p>
<dl class="simple">
<dt>develop branch</dt><dd><p><code class="docutils literal notranslate"><span class="pre">develop</span></code></p>
</dd>
<dt>feature branch</dt><dd><p><code class="docutils literal notranslate"><span class="pre">f&lt;major&gt;</span></code></p>
</dd>
<dt>release branch</dt><dd><p><code class="docutils literal notranslate"><span class="pre">r&lt;major&gt;.&lt;minor&gt;</span></code></p>
</dd>
<dt>tagged release</dt><dd><p><code class="docutils literal notranslate"><span class="pre">v&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;</span></code></p>
</dd>
</dl>
<p>FleCSI uses the information in <code class="docutils literal notranslate"><span class="pre">.version</span></code> to define
<code class="docutils literal notranslate"><span class="pre">FLECSI_VERSION</span></code> in its <code class="docutils literal notranslate"><span class="pre">flecsi-config.h</span></code> header. This constant
encodes the major, minor and patch version of FleCSI in a single
integer value.</p>
<p>For <strong>tagged releases</strong> (<code class="docutils literal notranslate"><span class="pre">v&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;</span></code>) it is defined
as <code class="docutils literal notranslate"><span class="pre">(major</span> <span class="pre">&lt;&lt;</span> <span class="pre">16)</span> <span class="pre">|</span> <span class="pre">(minor</span> <span class="pre">&lt;&lt;</span> <span class="pre">8)</span> <span class="pre">|</span> <span class="pre">patch</span></code>.</p>
<p>On <strong>release branches</strong> both major and minor version components are
set to the release version, however, the patch version component is set
to its maximul value 255.</p>
<p>On <strong>feature branches</strong> only the major version component is set to the
version value, while the minor version component is set to its maximum
255 and the patch version component is set to 0.</p>
<p>Finally, on the <strong>develop branch</strong>, the major version component is set
to its maximum 255, while the other componets are set
to 0.</p>
<p>The following table summarizes these rules with some examples:</p>
<table class="docutils align-default" id="id13">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Examples of <code class="docutils literal notranslate"><span class="pre">.version</span></code> and <code class="docutils literal notranslate"><span class="pre">FLECSI_VERSION</span></code></span><a class="headerlink" href="#id13" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Source</p></th>
<th class="head"><p>Contents of <code class="docutils literal notranslate"><span class="pre">.version</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">FLECSI_VERSION</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">develop</span></code> branch</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">develop</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0xff0000</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">2</span></code> feature branch</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">f2</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0x02ff00</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">2.1</span></code> release branch</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">r2.1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0x0201ff</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">v2.2.0</span></code> tagged release</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">v2.2.0</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">0x020200</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="workflow">
<h3>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h3>
<p>FleCSI development uses a <em>devel -&gt; feature -&gt; release</em> forking workflow
that can be visualized as in <a class="reference internal" href="#branch"><span class="std std-numref">Fig. 11</span></a>. Bugfixes and features can
be back-merged into <em>feature</em> or <em>devel</em>, as appropriate.</p>
<figure class="align-default" id="id14">
<span id="branch"></span><img alt="../_images/branch.png" src="../_images/branch.png" />
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Workflow diagram illustrating basic workflow using the three branch
types described above. (Figure due to Angela Herring.)</span><a class="headerlink" href="#id14" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
<hr class="docutils" />
<section id="published-documentation">
<h2>Published Documentation<a class="headerlink" href="#published-documentation" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="http://www.flecsi.org/">project homepage</a> is a GitHub Pages site generated from <a class="reference external" href="https://github.com/flecsi/flecsi/tree/gh-pages">the current GitHub repository</a>.
The <code class="docutils literal notranslate"><span class="pre">deploy-documentation</span></code> Make target sets up a repository to update it by pushing to the appropriate branch.</p>
<blockquote>
<div></div></blockquote>
</section>
<hr class="docutils" />
<section id="spack-cheat-sheet">
<h2>Spack Cheat Sheet<a class="headerlink" href="#spack-cheat-sheet" title="Permalink to this headline">¶</a></h2>
<p>To remove all cached sources:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack clean -d
</pre></div>
</div>
<p>To remove cached sources for a particular spec:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack clean -d spec
</pre></div>
</div>
<p>To uninstall all spack packages:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack uninstall -fay
</pre></div>
</div>
<p>To keep temporary staging files in /tmp/<em>$USER</em>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>spack install --keep-stage ...
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="git-cheat-sheet">
<h2>Git Cheat Sheet<a class="headerlink" href="#git-cheat-sheet" title="Permalink to this headline">¶</a></h2>
<p>To lookup the hash referenced by a tag:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git rev-list -n <span class="m">1</span> <span class="nv">$TAG</span>
</pre></div>
</div>
<p>To get the message for an annotated tag:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git tag -nX <span class="o">(</span>X specifies lines of annotation<span class="o">)</span>
</pre></div>
</div>
<p>To sync tags:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git fetch --prune --prune-tags
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="building-for-darwin">
<h2>Building for Darwin<a class="headerlink" href="#building-for-darwin" title="Permalink to this headline">¶</a></h2>
<p>Darwin is a testbed cluster at LANL that provides a wide variety of
node hardware configurations.  (See the <a class="reference external" href="https://darwin.lanl.gov/">LANL-internal Darwin webpage</a>.)  The FleCSI distribution provides a
script, <code class="docutils literal notranslate"><span class="pre">tools/darwin.sh</span></code>, that automates downloading, building, and
installing FleCSI and all of its dependencies.  The script can be run
either from a checked-out version of the FleCSI repository, in which
case it will not re-download FleCSI, or as a standalone script, in
which case it will clone the <code class="docutils literal notranslate"><span class="pre">flecsi</span></code> repository and build from
there.</p>
<p>The former is the preferred approach.  From a back-end node, run</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git clone git@gitlab.lanl.gov:flecsi/flecsi.git
<span class="gp">$ </span>flecsi/tools/darwin.sh
</pre></div>
</div>
<p>The script performs the following operations:</p>
<ol class="arabic simple">
<li><p>Clone <code class="docutils literal notranslate"><span class="pre">flecsi</span></code> if the script was not run as above, from a cloned
repository.</p></li>
<li><p>Install a version of the <a class="reference external" href="https://spack.readthedocs.io/">Spack package manager</a> known to work with FleCSI into
<code class="docutils literal notranslate"><span class="pre">$HOME/spack</span></code>.</p></li>
<li><p>Load Darwin’s <a class="reference external" href="http://modules.sourceforge.net/">environment modules</a> for known-to-work-with-FleCSI
versions of various tools.</p></li>
<li><p>Create and activate a <code class="docutils literal notranslate"><span class="pre">flecsi-mpich</span></code> Spack environment.
Download, build, and install FleCSI’s dependencies into this
environment.  (This is by far the more time-consuming part of the
script.  Plan on about 45 minutes.)</p></li>
<li><p>Configure, build, test, and install FleCSI into
<code class="docutils literal notranslate"><span class="pre">$HOME/flecsi-inst</span></code>, including documentation.</p></li>
<li><p>Configure and build the FleCSI tutorial files.  This ensures that
it is possible to compile and link against the headers and
libraries in <code class="docutils literal notranslate"><span class="pre">$HOME/flecsi-inst</span></code>.</p></li>
</ol>
<p>The script expects a fairly virgin environment.  It currently fails if
Spack is already installed, conflicting modules are already loaded, or
other aspects of the installation already have been run.</p>
<p>Once the script completes, you can activate the FleCSI environment with</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">source</span> ~/spack/share/spack/setup-env.sh
<span class="gp">$ </span>spack env activate flecsi-mpich
</pre></div>
</div>
<p>The complete <code class="docutils literal notranslate"><span class="pre">tools/darwin.sh</span></code> script is reproduced below.  Although
the script is intended to be run on the Darwin cluster, it should not
be too hard to adapt it to other systems or even simply use the script
as a reference for the commands needed to get FleCSI up and running.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#! /bin/bash</span>

<span class="c1">######################################</span>
<span class="c1"># Build FleCSI entirely from scratch #</span>
<span class="c1"># (tested on LANL&#39;s Darwin cluster)  #</span>
<span class="c1">######################################</span>

<span class="c1"># Trace commands and abort on the first error.</span>
<span class="nb">set</span> -e
<span class="nb">set</span> -v

<span class="c1"># Check if we&#39;re running from within a flecsi clone.  If not, clone</span>
<span class="c1"># flecsi into the current directory.  In either case, cd to the</span>
<span class="c1"># top-level flecsi directory.</span>
<span class="nv">script_dir</span><span class="o">=</span><span class="k">$(</span>dirname <span class="k">$(</span>readlink -f <span class="s2">&quot;</span><span class="nv">$0</span><span class="s2">&quot;</span><span class="k">))</span>
<span class="nb">cd</span> <span class="s2">&quot;</span><span class="nv">$script_dir</span><span class="s2">&quot;</span>
<span class="nv">repo_name</span><span class="o">=</span><span class="k">$(</span>basename -s .git <span class="k">$(</span>git config --get remote.origin.url <span class="o">||</span> <span class="nb">echo</span> not-flecsi<span class="k">))</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$repo_name</span><span class="s2">&quot;</span> <span class="o">==</span> flecsi <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
    <span class="nb">cd</span> <span class="k">$(</span>git rev-parse --show-toplevel<span class="k">)</span>
<span class="k">else</span>
    <span class="nb">cd</span> -
    git clone git@gitlab.lanl.gov:flecsi/flecsi.git
    <span class="nb">cd</span> flecsi
<span class="k">fi</span>
git rev-parse HEAD

<span class="c1"># Create a build subdirectory and cd to it.</span>
<span class="nb">test</span> -d build <span class="o">&amp;&amp;</span> rm -rf build
mkdir build
<span class="nb">cd</span> build

<span class="c1"># Define an installation directory.</span>
<span class="nv">FLECSI_INSTALL</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/flecsi-inst&quot;</span>

<span class="c1"># Set GCC version we&#39;re going to use</span>
<span class="nv">GCC_VERSION</span><span class="o">=</span><span class="m">11</span>.1.0

<span class="c1"># Download a version of Spack known to work with FleCSI and activate it.</span>
<span class="nv">SPACK_VERSION</span><span class="o">=</span>v0.19
<span class="nb">pushd</span> <span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">&quot;</span>
<span class="k">if</span> <span class="o">[</span> ! -d spack <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  git clone https://github.com/spack/spack.git
  <span class="nb">cd</span> spack
  git switch releases/<span class="nv">$SPACK_VERSION</span>
  git rev-parse HEAD
<span class="k">else</span>
  <span class="nb">cd</span> spack
  <span class="nb">echo</span> <span class="s2">&quot;Found existing Spack install in ~/spack&quot;</span>
  git fetch origin
  <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="k">$(</span>git rev-parse HEAD<span class="k">)</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s2">&quot;</span><span class="k">$(</span>git rev-parse origin/releases/<span class="nv">$SPACK_VERSION</span><span class="k">)</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;ERROR: The current checkout does not match origin/releases/</span><span class="nv">$SPACK_VERSION</span><span class="s2">!&quot;</span>
    <span class="nb">echo</span>
    <span class="nb">echo</span> <span class="s2">&quot;Please update manually with:&quot;</span>
    <span class="nb">echo</span> <span class="s2">&quot; git -C ~/spack fetch +releases/</span><span class="nv">$SPACK_VERSION</span><span class="s2">:refs/remotes/origin/releases/</span><span class="nv">$SPACK_VERSION</span><span class="s2">&quot;</span>
    <span class="nb">echo</span> <span class="s2">&quot; git -C ~/spack switch origin/releases/</span><span class="nv">$SPACK_VERSION</span><span class="s2">&quot;</span>
    <span class="nb">echo</span>
    <span class="nb">echo</span> <span class="s2">&quot;WARNING: This may invalidate other Spack environments that rely on&quot;</span> <span class="se">\</span>
         <span class="s2">&quot;this Spack instance!&quot;</span>
    <span class="nb">exit</span> <span class="m">1</span>
  <span class="k">fi</span>
<span class="k">fi</span>
<span class="nb">set</span> +v
<span class="nb">source</span> <span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/spack/share/spack/setup-env.sh&quot;</span>
<span class="nb">set</span> -v
<span class="nb">popd</span>


<span class="c1"># Create new Spack environment and activate it</span>
spack env remove -y flecsi-mpich <span class="o">||</span> <span class="nb">true</span>
spack env create flecsi-mpich
spack env activate flecsi-mpich

<span class="c1"># Load GCC version known to work with FleCSI</span>
<span class="c1"># and make it visible to Spack</span>
<span class="nb">set</span> +v
module load gcc/<span class="si">${</span><span class="nv">GCC_VERSION</span><span class="si">}</span>
spack compiler find
<span class="nb">set</span> -v

<span class="c1"># ignore configuration in ~/.spack to avoid conflicts</span>
<span class="nb">export</span> <span class="nv">SPACK_DISABLE_LOCAL_CONFIG</span><span class="o">=</span><span class="nb">true</span>

<span class="c1"># allow spack to dynamically concretize packages together instead of separately.</span>
<span class="c1"># this avoids some installation errors due to multiple python packages depending</span>
<span class="c1"># on different versions of a dependency</span>
spack config add concretizer:reuse:false
spack config add packages:all:compiler:<span class="o">[</span><span class="s2">&quot;gcc@</span><span class="si">${</span><span class="nv">GCC_VERSION</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">]</span>

<span class="c1"># add FleCSI spack package repository</span>
spack repo add ../spack-repo

<span class="c1"># On Darwin we have a Spack upstream that already has prebuilt dependencies</span>
<span class="nv">DARWIN_SPACK_UPSTREAM</span><span class="o">=</span>/projects/flecsi-devel/gitlab/spack-upstream/<span class="nv">$SPACK_VERSION</span>

<span class="k">if</span> <span class="o">[</span> -d <span class="s2">&quot;</span><span class="nv">$DARWIN_SPACK_UPSTREAM</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> -x <span class="s2">&quot;</span><span class="si">${</span><span class="nv">DARWIN_SPACK_UPSTREAM</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="c1"># add spack upstream if accessible</span>
  spack config add upstreams:default:install_tree:<span class="si">${</span><span class="nv">DARWIN_SPACK_UPSTREAM</span><span class="si">}</span>/opt/spack/
  cp <span class="si">${</span><span class="nv">DARWIN_SPACK_UPSTREAM</span><span class="si">}</span>/etc/spack/packages.yaml <span class="nv">$HOME</span>/spack/etc/spack/
<span class="k">else</span>
  <span class="c1"># Otherwise, load a compatible cmake and expose whatever else happens to be</span>
  <span class="c1"># sitting around as Spack externals</span>
  module load cmake/3.19.2
  spack external find
<span class="k">fi</span>

<span class="c1"># Install FleCSI&#39;s dependencies with Spack.</span>
<span class="c1"># This also builds a version of MPICH in Spack since the ones on Darwin do not include</span>
<span class="c1"># an mpiexec/mpirun that works.</span>
spack add flecsi%gcc@<span class="si">${</span><span class="nv">GCC_VERSION</span><span class="si">}</span> <span class="nv">backend</span><span class="o">=</span>legion +doc +hdf5 +kokkos +flog <span class="se">\</span>
          ^mpich@3.4.2%gcc@<span class="si">${</span><span class="nv">GCC_VERSION</span><span class="si">}</span>+hydra+romio~verbs <span class="nv">device</span><span class="o">=</span>ch4 <span class="se">\</span>
          ^legion <span class="nv">network</span><span class="o">=</span>gasnet <span class="nv">conduit</span><span class="o">=</span>mpi <span class="nv">build_type</span><span class="o">=</span>Debug
spack install -j <span class="k">$(</span>nproc<span class="k">)</span> --only dependencies

<span class="c1"># Build, test, and install FleCSI.</span>
../tools/configure gnu legion -DCMAKE_INSTALL_PREFIX<span class="o">=</span><span class="s2">&quot;</span><span class="nv">$FLECSI_INSTALL</span><span class="s2">&quot;</span>
make <span class="nv">VERBOSE</span><span class="o">=</span><span class="m">1</span> -j <span class="k">$(</span>nproc<span class="k">)</span>
make <span class="nb">test</span>
make install
<span class="nb">cd</span> ..

<span class="c1"># Ensure the tutorial examples build properly.</span>
<span class="nb">cd</span> tutorial
<span class="nb">test</span> -d build <span class="o">&amp;&amp;</span> rm -rf build
mkdir build
<span class="nb">cd</span> build
cmake -DFleCSI_DIR<span class="o">=</span><span class="s2">&quot;</span><span class="nv">$FLECSI_INSTALL</span><span class="s2">/lib64/cmake/FleCSI&quot;</span> ..
make -j <span class="k">$(</span>nproc<span class="k">)</span>
<span class="nb">cd</span> ../..

<span class="c1"># Build complete</span>
<span class="nb">set</span> +v
<span class="nb">echo</span> <span class="s2">&quot;BUILD COMPLETE&quot;</span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s2">&quot;To continue working in the same Spack environment, execute the following commands:&quot;</span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s2">&quot; source \$HOME/spack/share/spack/setup-env.sh&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot; spack env activate flecsi-mpich&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot; module load gcc/</span><span class="si">${</span><span class="nv">GCC_VERSION</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="nb">echo</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="graphviz-notes">
<h2>Graphviz Notes<a class="headerlink" href="#graphviz-notes" title="Permalink to this headline">¶</a></h2>
<p>FleCSI uses the <a class="reference external" href="https://graphviz.gitlab.io/_pages/pdf/libguide.pdf">libcgraph</a> interface to <a class="reference external" href="https://www.graphviz.org">Graphviz</a> to create
control model visualizations. The <em>libcgraph</em> interface is fairly
counterintuitive. One particular gotcha is that graph, node, and edge
attributes can only be set on attributes that have been defined for the
graph. If an attribute type has not been defined, the graph will ignore
it. There is not easy to remedy to this problem: attributes that are
added after initialization will reset all previously added elements to
whatever the default of the new attribute is. Therefore, if you need to
add an attribute, the best thing to do is to look at the <em>graphviz.hh</em>
file in ‘flecsi/util’ and add it there with a reasonable default.</p>
</section>
<hr class="docutils" />
<section id="doxygen">
<h2>Doxygen<a class="headerlink" href="#doxygen" title="Permalink to this headline">¶</a></h2>
<p>The API reference is organized exclusively using the groups feature; none of the files and namespaces are documented, since they have little relevance to the user.
See the <a class="reference external" href="https://www.doxygen.nl/manual/">manual</a> for details, but note that members of namespaces enclosed by the <code class="docutils literal notranslate"><span class="pre">\{</span></code> and <code class="docutils literal notranslate"><span class="pre">\}</span></code> of a grouping command are not included in the group.</p>
<p>The developers’ version of the API reference includes a selection of internal interfaces for core developers (who of course must nonetheless consult the source in general).
Use <code class="docutils literal notranslate"><span class="pre">\cond</span> <span class="pre">core</span></code> and <code class="docutils literal notranslate"><span class="pre">\endcond</span></code> to mark material that should appear only there.
Developers must also check for such markers to identify internal interfaces; the output does not distinguish them, since users should consult only the users’ version anyway.</p>
</section>
<hr class="docutils" />
<section id="sphinx">
<h2>Sphinx<a class="headerlink" href="#sphinx" title="Permalink to this headline">¶</a></h2>
<p>Sphinx documentation is <a class="reference external" href="https://www.sphinx-doc.org/en/master">here</a>.
The following are some examples of frequently-used elements.
However, a good practice is to just look at the existing documentation
to figure out how something was done.</p>
<section id="headings">
<h3>Headings<a class="headerlink" href="#headings" title="Permalink to this headline">¶</a></h3>
<p>By convention, headings are underlined with characters in the order <code class="docutils literal notranslate"><span class="pre">*+^=</span></code>.</p>
</section>
<section id="links">
<h3>Links<a class="headerlink" href="#links" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>For more information look at `sphinx`__.

__ https://www.sphinx-doc.org/en/master/usage/restructuredtext/index.html
</pre></div>
</div>
<p>This will be rendered like:</p>
<p>For more information look at <a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/restructuredtext/index.html">sphinx</a>.</p>
</section>
<section id="figures">
<h3>Figures<a class="headerlink" href="#figures" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">_undersea</span><span class="p">:</span>
<span class="o">..</span> <span class="n">figure</span><span class="p">::</span> <span class="n">images</span><span class="o">/</span><span class="n">undersea</span><span class="o">.</span><span class="n">png</span>
  <span class="p">:</span><span class="n">align</span><span class="p">:</span> <span class="n">center</span>
  <span class="p">:</span><span class="n">width</span><span class="p">:</span> <span class="mi">70</span><span class="o">%</span>

  <span class="n">A</span> <span class="n">colorful</span> <span class="n">image</span> <span class="n">resembling</span> <span class="n">a</span> <span class="n">cosmic</span> <span class="n">version</span> <span class="n">of</span> <span class="n">an</span> <span class="n">undersea</span> <span class="n">world</span><span class="o">.</span>
</pre></div>
</div>
<p>This will be rendered like:</p>
<figure class="align-center" id="id15">
<span id="undersea"></span><a class="reference internal image-reference" href="../_images/undersea.png"><img alt="../_images/undersea.png" src="../_images/undersea.png" style="width: 70%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">A colorful image resembling a cosmic version of an undersea world.</span><a class="headerlink" href="#id15" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>You can reference the figure using its label <em>undersea</em> like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>As can be seen in :numref:`undersea`...
</pre></div>
</div>
<p>This will be rendered like:</p>
<p>As can be seen in <a class="reference internal" href="#undersea"><span class="std std-numref">Fig. 12</span></a>…</p>
</section>
<section id="code-blocks">
<h3>Code Blocks<a class="headerlink" href="#code-blocks" title="Permalink to this headline">¶</a></h3>
<p>Syntax highlighting for codes blocks uses <a class="reference external" href="https://pygments.org">pygments</a>, which supports
many programming and markup languages.</p>
<p>Here are two examples:</p>
<section id="console">
<h4>Console<a class="headerlink" href="#console" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.. code-block:: console

  $ xterm -hold -fs 10 -bg black -fg white -geometry 128x40 -e curl wttr.in
</pre></div>
</div>
<p>This will be rendered like:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>xterm -hold -fs <span class="m">10</span> -bg black -fg white -geometry 128x40 -e curl wttr.in
</pre></div>
</div>
</section>
<section id="c">
<h4>C++<a class="headerlink" href="#c" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">code</span><span class="o">-</span><span class="n">block</span><span class="p">::</span> <span class="n">cpp</span>

  <span class="n">template</span><span class="o">&lt;</span><span class="n">typename</span> <span class="n">Bar</span><span class="o">&gt;</span>
  <span class="n">using</span> <span class="n">Baz</span> <span class="o">=</span> <span class="n">Foo</span><span class="o">&lt;</span><span class="n">Bar</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<p>This will be rendered like:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="nc">Bar</span><span class="o">&gt;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">Baz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Foo</span><span class="o">&lt;</span><span class="n">Bar</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="literal-includes">
<h3>Literal Includes<a class="headerlink" href="#literal-includes" title="Permalink to this headline">¶</a></h3>
<p>Literal includes allow you to directly include source code or other
inputs from the actual file you are referencing. This is useful because
any changes to the file will automatically be captured in the
documentation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">..</span> <span class="n">literalinclude</span><span class="p">::</span> <span class="o">../../../</span><span class="n">tutorial</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">control</span><span class="o">/</span><span class="mi">1</span><span class="o">-</span><span class="n">simple</span><span class="o">.</span><span class="n">cc</span>
  <span class="p">:</span><span class="n">language</span><span class="p">:</span> <span class="n">cpp</span>
  <span class="p">:</span><span class="n">start</span><span class="o">-</span><span class="n">at</span><span class="p">:</span> <span class="o">//</span> <span class="n">Function</span> <span class="n">definition</span> <span class="n">of</span> <span class="n">an</span> <span class="n">advance</span> <span class="n">action</span><span class="o">.</span>
  <span class="p">:</span><span class="n">end</span><span class="o">-</span><span class="n">before</span><span class="p">:</span> <span class="o">//</span> <span class="n">Register</span> <span class="n">the</span> <span class="n">finalize</span> <span class="n">action</span> <span class="n">under</span> <span class="n">the</span> <span class="s1">&#39;finalize&#39;</span> <span class="n">control</span> <span class="n">point</span><span class="o">.</span>
</pre></div>
</div>
<p>This will be rendered like:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Function definition of an advance action.</span>

<span class="kt">void</span><span class="w"></span>
<span class="nf">advance</span><span class="p">(</span><span class="n">control_policy</span><span class="w"> </span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">flog</span><span class="p">(</span><span class="n">info</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;advance&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// Register the advance action under the &#39;advance&#39; control point.</span>

<span class="n">control</span><span class="o">::</span><span class="n">action</span><span class="o">&lt;</span><span class="n">advance</span><span class="p">,</span><span class="w"> </span><span class="n">cp</span><span class="o">::</span><span class="n">advance</span><span class="o">&gt;</span><span class="w"> </span><span class="n">advance_action</span><span class="p">;</span><span class="w"></span>

<span class="c1">// Function definition of a finalize action.</span>

<span class="kt">void</span><span class="w"></span>
<span class="nf">finalize</span><span class="p">(</span><span class="n">control_policy</span><span class="w"> </span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">flog</span><span class="p">(</span><span class="n">info</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;finalize&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>The included parts of the file begin with a <code class="docutils literal notranslate"><span class="pre">:start-at:</span></code> or
<code class="docutils literal notranslate"><span class="pre">:start-after:</span></code> input and end with an <code class="docutils literal notranslate"><span class="pre">:end-at:</span></code> or <code class="docutils literal notranslate"><span class="pre">:end-before:</span></code> input. Each
of these performs a literal string match for the string that follows the colon.
That is, <code class="docutils literal notranslate"><span class="pre">:start-at:</span> <span class="pre">some</span> <span class="pre">text</span></code> will match against the string <code class="docutils literal notranslate"><span class="pre">some</span> <span class="pre">text</span></code> and
will start including the entire line it contains. Similarly,
<code class="docutils literal notranslate"><span class="pre">:start-after:</span></code> will match the same line, but only start including after
the line containing the string. <code class="docutils literal notranslate"><span class="pre">:end-at:</span></code> and <code class="docutils literal notranslate"><span class="pre">:end-before:</span></code> work in a
similar fashion. Note that for the above we included the block of
comments that matched <code class="docutils literal notranslate"><span class="pre">//</span> <span class="pre">Function</span> <span class="pre">definition</span> <span class="pre">of</span> <span class="pre">an</span> <span class="pre">advance</span> <span class="pre">action.</span></code>
and we stopped including just before a line that begins another comment
block section for another part of the code. Since an <code class="docutils literal notranslate"><span class="pre">end-before</span></code> was
used, the line containing the matched string was not included.</p>
</section>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="summary.html" class="btn btn-neutral float-right" title="Internal Summary" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="api.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright Copyright (C) 2016, Triad National Security, LLC.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    

  <style>
    /* Contents caption */
    .wy-menu-vertical>p.caption {
      color: #ffffff;
    }

    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #e3e2db;
    }
    .wy-side-nav-search>div.version, .wy-nav-top>div.version {
      color: #5f5d5f;
    }

    /* Sidebar */
    .wy-nav-side {
      background: #216897;
      color: #ffffff;
    }
  </style>


</body>
</html>